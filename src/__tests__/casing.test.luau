local jestGlobals = require('@pkg/@jsdotlua/jest-globals')

local character = require('../character')

local expect = jestGlobals.expect
local it = jestGlobals.it
local describe = jestGlobals.describe

local TO_UPPER_CASES = {
    { 'a', 'A' },
    { 'i', 'I' },
    { 'Ã¡', 'Ã' },
    { 'Ã£', 'Ãƒ' },
    { 'Ã§', 'Ã‡' },
    { 'Ã©', 'Ã‰' },
    { 'Ã¶', 'Ã–' },
    { 'È', 'Èœ' },
    { 'Î´', 'Î”' },
    { 'Ï‚', 'Î£' },
    { 'Ñ—', 'Ð‡' },
    { 'Õ¡', 'Ô±' },
    { 'Õº', 'ÕŠ' },
    { 'á¸ƒ', 'á¸‚' },
    { 'á¹µ', 'á¹´' },
    { 'â°·', 'â°‡' },
    { 'â³—', 'â³–' },
    { 'ê­½', 'áŽ­' },
    { 'ï¬„', 'FFL' },
}

local TO_LOWER_CASES = {
    { 'A', 'a' },
    { 'FFL', 'ffl' },
    { 'I', 'i' },
    { 'Ã', 'Ã¡' },
    { 'Ãƒ', 'Ã£' },
    { 'Ã‡', 'Ã§' },
    { 'Ã‰', 'Ã©' },
    { 'Ã–', 'Ã¶' },
    { 'Èœ', 'È' },
    { 'Î”', 'Î´' },
    { 'Î£', 'Ïƒ' },
    { 'Ð‡', 'Ñ—' },
    { 'Ô±', 'Õ¡' },
    { 'ÕŠ', 'Õº' },
    { 'áŽ­', 'ê­½' },
    { 'á¸‚', 'á¸ƒ' },
    { 'á¹´', 'á¹µ' },
    { 'â°‡', 'â°·' },
    { 'â³–', 'â³—' },
}

local UNCHANGED_CASES = {
    '-',
    '0',
    '1',
    '{',
    '\\',
    '\n',
    'á´‚',
    'ð›‡',
    'ð”°',
    'ð•’',
    'â„³',
}

describe('toLowercase', function()
    for _, case in TO_LOWER_CASES do
        local upper = case[1]
        local lower = case[2]

        it(`converts '{upper}' to '{lower}'`, function()
            if character.toLowercase(upper) ~= lower then
                error(
                    'toLowercase '
                        .. upper
                        .. ' -> '
                        .. character.toLowercase(upper)
                        .. ' expected '
                        .. lower
                )
            end
            expect(character.toLowercase(upper) == lower).toBe(true)
        end)

        it(`keeps '{lower}' unchanged`, function()
            expect(character.toLowercase(lower) == lower).toBe(true)
        end)
    end

    for _, case in UNCHANGED_CASES do
        it(`keeps '{case}' unchanged`, function()
            expect(character.toLowercase(case)).toEqual(case)
        end)
    end
end)

describe('toUppercase', function()
    for _, case in TO_UPPER_CASES do
        local lower = case[1]
        local upper = case[2]

        it(`converts '{lower}' to '{upper}'`, function()
            if character.toUppercase(lower) ~= upper then
                error(
                    'toUppercase '
                        .. lower
                        .. ' -> '
                        .. character.toUppercase(lower)
                        .. ' expected '
                        .. upper
                )
            end
            expect(character.toUppercase(lower) == upper).toBe(true)
        end)

        it(`keeps '{upper}' unchanged`, function()
            expect(character.toUppercase(upper) == upper).toBe(true)
        end)
    end

    for _, case in UNCHANGED_CASES do
        it(`keeps '{case}' unchanged`, function()
            expect(character.toUppercase(case)).toEqual(case)
        end)
    end
end)
